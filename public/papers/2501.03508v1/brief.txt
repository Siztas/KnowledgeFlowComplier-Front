### 自动化提示工程中的序列最优学习方法

在大型语言模型（LLM）的应用中，设计有效的提示（prompt）对于引导模型产生预期的响应至关重要。自动化提示工程旨在通过简化设计、优化和调整提示的过程，减少对人工干预的依赖。本文提出了一种自动化提示工程的最优学习框架，旨在通过有效分配有限的评估预算，逐步识别有效的提示特征。我们引入了一种基于特征的方法来表达提示，显著扩展了搜索空间，并采用贝叶斯回归来利用相似提示之间的相关性，加速学习过程。为了高效探索大量的提示特征空间，我们采用了前瞻性的知识梯度（KG）策略进行序列最优学习，并通过求解混合整数二阶锥优化问题来高效计算KG策略。这种方法具有良好的扩展性，能够处理仅通过约束来定义的提示特征。

通过对比实验，本文展示了所提出的方法在指令生成任务中的显著优势。实验结果表明，在有限的评估预算下，KG策略在选择高质量提示方面优于一系列基准策略。特别是在评估成本较高的应用场景中，我们的方法能够显著提高提示工程的效率，从而为自动化提示工程在更多实际应用中的部署提供了可行的解决方案。

本文提出了一种解释性强的基于特征的提示表示方法，可以捕捉提示中不同属性之间的相互作用，不仅避免了以往方法中的提示特征孤立处理问题，还能够在不依赖人工指定的提示集的情况下，探索出更多的提示变体。此外，采用的贝叶斯方法能够帮助我们在有限的评估次数下，逐步优化对提示特征影响的认识，捕捉特征之间的相关性，进而加速学习进程。

在提示工程的迭代优化过程中，我们将问题形式化为一个有限步数的马尔可夫决策过程，KG策略作为一种前瞻性的方法，能够在每一阶段最大化信息价值的期望改进。对于大规模提示特征空间的挑战，本文通过混合整数锥优化方法有效解决了计算瓶颈，并且提升了该策略的可扩展性。

最后，我们在指令生成任务的基准数据集上评估了我们的方法，结果表明，KG策略在30次以内的提示评估中即可收敛至高质量的提示，相比其他基准方法，所生成的提示在测试数据上表现更好。我们的研究表明，在面对高不确定性和对提示敏感度较高的任务时，KG策略能够提供显著的优势，尤其适用于提示评估成本较高的实际应用场景。
